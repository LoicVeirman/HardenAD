<?xml version="1.0" encoding="utf-8"?>
<!--  (c) 2015 Microsoft Corporation  -->
<policyDefinitionResources xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" revision="1.0" schemaVersion="1.0" xmlns="http://schemas.microsoft.com/GroupPolicy/2006/07/PolicyDefinitions">
  <displayName>Microsoft Windows Device Guard</displayName>
  <description>Безопасность Windows Device Guard</description>
  <resources>
    <stringTable>
      <string id="DeviceGuard">Device Guard</string>
      <string id="VirtualizationBasedSecurity">Включить средство обеспечения безопасности на основе виртуализации</string>
      <string id="VirtualizationBasedSecurityHelp">Указывает, включена ли безопасность на основе виртуализации.

Безопасность на основе виртуализации использует низкоуровневую оболочку Windows для поддержки служб безопасности. Безопасность на основе виртуализации требует безопасной загрузки и может быть включена с помощью средств защиты DMA. Средства защиты DMA требуют аппаратной поддержки и будут включены только на правильно настроенных устройствах.

Защита целостности кода на основе виртуализации

Этот параметр включает защиту целостности кода в режиме ядра на основе виртуализации. Если этот параметр включен, принудительно применяются средства защиты памяти в режиме ядра, а путь проверки целостности кода защищается с помощью безопасности на основе виртуализации.

Параметр "Отключено" удаленно отключает защиту целостности кода на основе виртуализации, если ранее она была включена с помощью параметра "Включено без блокировки".

Параметр "Включено с блокировкой UEFI" гарантирует, что защиту целостности кода на основе виртуализации нельзя отключить удаленно. Для отключения этой функции необходимо установить для групповой политики значение "Отключено", а также удалить функции безопасности на всех компьютерах с физическим присутствием пользователя, чтобы очистить конфигурацию, сохраненную в UEFI.

Параметр "Включено без блокировки" позволяет удаленно отключить защиту целостности кода на основе виртуализации с помощью групповой политики.

При выборе параметра "Не настроено" параметр политики остается неопределенным. Групповая политика не записывает параметр политики в реестр, поэтому он не влияет на компьютеры или пользователей. Если в реестре есть текущий параметр, он не будет изменен.

Параметр "Требовать таблицу атрибутов памяти UEFI" включает защиту целостности кода на основе виртуализации только на устройствах, на которых встроенное ПО UEFI поддерживает таблицу атрибутов памяти. На устройствах без таблицы атрибутов памяти UEFI может быть установлено встроенное ПО, несовместимое с защитой целостности кода на основе виртуализации, что в некоторых случаях может привести к сбоям, потере данных или несовместимости с определенными подключаемыми картами. Если этот параметр не настроен, целевые устройства следует тестировать на совместимость.

Внимание! Все драйверы системы должны быть совместимы с этой функцией. В противном случае может возникать сбой системы. Разворачивайте этот параметр политики только на совместимых компьютерах.

Credential Guard

Этот параметр позволяет пользователям включать Credential Guard с помощью безопасности на основе виртуализации, чтобы защитить учетные данные.

Для Windows 11 21H2 и более ранних версий параметр "Отключено" удаленно отключает Credential Guard, если ранее он был включен с помощью параметра "Включено без блокировки". Для более поздних версий параметр "Отключено" удаленно отключает Credential Guard, если ранее он был включен с помощью параметра "Включено без блокировки" или ему было присвоено значение "Не настроено".

Параметр "Включено с блокировкой UEFI" гарантирует, что Credential Guard невозможно отключить удаленно. Чтобы отключить эту функцию, необходимо установить для групповой политики значение "Отключено", а также удалить функции безопасности на всех компьютерах с физическим присутствием пользователя, чтобы очистить конфигурацию, сохраненную в UEFI.

Параметр "Включено без блокировки" позволяет удаленно отключить Credential Guard с помощью групповой политики. Устройства, использующие этот параметр, должны работать под управлением Windows 10 (версия 1511) или более поздней версии.

Для Windows 11 21H2 и более ранних версий выбор параметра "Не настроено" оставляет параметр политики неопределенным. Групповая политика не записывает параметр политики в реестр, поэтому он не влияет на компьютеры или пользователей. Если в реестре есть текущий параметр, он не будет изменен. Для более поздних версий: если в реестре нет текущего параметра, параметр "Не настроено" включает Credential Guard без блокировки UEFI.

Безопасный запуск

Этот параметр настраивает конфигурацию безопасного запуска для защиты цепочки загрузки.

По умолчанию используется параметр "Не настроено", что позволяет настраивать функцию пользователям с правами администратора.

Параметр "Включено" включает безопасный запуск на поддерживаемом оборудовании.

Параметр "Отключено" отключает безопасный запуск независимо от аппаратной поддержки.

Защита стека в режиме ядра с аппаратным обеспечением

Этот параметр включает защиту стека с аппаратным обеспечением для кода в режиме ядра. Если эта функция безопасности включена, стеки данных в режиме ядра защищены аппаратным теневыми стеками, в которых хранятся целевые адреса возврата, чтобы гарантировать отсутствие незаконного изменения потока управления программой.

К этой функции предъявляются следующие предварительные требования.
1) Оборудование ЦП поддерживает аппаратные теневые стеки.
2) Включена защита целостности кода на основе виртуализации.

Если предварительные требования не выполнены, эта функция не включается, даже если для нее выбран параметр "Включено". Обратите внимание, что при выборе параметра "Включено" для этой функции не будет автоматически включена защита целостности кода на основе виртуализации, которую необходимо выполнять отдельно.

Устройства, поддерживающие эту функцию безопасности, должны работать под управлением Windows 11 (версия 22H2) или более поздней версии.

Параметр "Отключено" отключает защиту стека в режиме ядра с аппаратным обеспечением.

Параметр "Включено в режиме аудита" включает защиту стека в режиме ядра с аппаратным обеспечением в режиме аудита, в котором нарушения теневого стека не являются неустранимыми и заносятся в журнал системных событий.

Параметр "Включено в режиме принудительного применения" включает защиту стека в режиме ядра с аппаратным обеспечением в режиме принудительного применения, в котором нарушения теневого стека неустранимы.

Выбор параметра "Не настроено" оставляет параметр политики неопределенным. Групповая политика не записывает параметр политики в реестр, поэтому он не влияет на компьютеры или пользователей. Если в реестре есть текущий параметр, он не будет изменен.

Внимание! Все драйверы системы должны быть совместимы с этой функцией безопасности. В противном случае может возникнуть сбой системы в режиме принудительного применения. Режим аудита можно использовать для обнаружения несовместимых драйверов. Дополнительные сведения: https://go.microsoft.com/fwlink/?LinkId=2162953.
      </string>
      <string id="SecureBoot">Безопасная загрузка</string>
      <string id="SecureBootAndDmaProtection">Безопасная загрузка и защита DMA</string>
      <string id="Disabled">Выключено</string>
      <string id="Enabled">Включено</string>
      <string id="EnabledWithoutLock">Включено без блокировки</string>
      <string id="EnabledWithUefiLock">Включено с блокировкой UEFI</string>
      <string id="EnabledAudit">Включено в режиме аудита</string>
      <string id="EnabledEnforcement">Включено в режиме принудительного применения</string>
      <string id="NotConfigured">Не настроено</string>
      <string id="ConfigCIPolicy">Развертывание функции управления приложениями в Защитнике Windows</string>
      <string id="ConfigCIPolicyHelp">Развертывание Защитник Windows управления приложениями

Этот параметр политики позволяет развертывать политику целостности кода на компьютере для управления разрешенным выполнением на этом компьютере.

При развертывании политики целостности кода Windows ограничивает возможности запуска в режиме ядра и на рабочем столе Windows на основе этой политики. Чтобы включить эту политику, необходимо перезагрузить компьютер.

Путь к файлу должен быть либо UNC-путем (например, \\ServerName\ShareName\SIPolicy.p7b), либо локально допустимым путем (например, C:\FolderName\SIPolicy.p7b).  Учетная запись локального компьютера (LOCAL SYSTEM) должна иметь разрешение на доступ к файлу политики.

Если используется подписанная и защищенная политика, то отключение этого параметра политики не удаляет эту функцию с компьютера. Вместо этого необходимо либо:

1) сначала обновите политику до не защищенной политики, а затем отключите параметр или
   2) отключите этот параметр, а затем удалите политику с каждого компьютера с физическим пользователем.
      </string>
    </stringTable>
    <presentationTable>
      <presentation id="VirtualizationBasedSecurity">
        <dropdownList refId="RequirePlatformSecurityFeaturesDrop" defaultItem="1">Выберите уровень безопасности платформы:</dropdownList>
        <dropdownList refId="HypervisorEnforcedCodeIntegrityDrop" defaultItem="3">Защита проверки целостности кода на основе виртуализации:</dropdownList>
        <checkBox refId="CheckboxMAT">Требовать таблицу атрибутов памяти UEFI</checkBox>
        <dropdownList refId="CredentialIsolationDrop" defaultItem="3">Конфигурация Credential Guard</dropdownList>
        <dropdownList refId="SystemGuardDrop" defaultItem="2">Настройка безопасного запуска:</dropdownList>
        <dropdownList refId="KernelShadowStacksDrop" defaultItem="3">Принудительная аппаратная защита стека в режиме ядра:</dropdownList>
      </presentation>
      <presentation id="ConfigCIPolicy">
        <textBox refId="ConfigCIPolicyFilePathText">
          <label>Путь к файлу политики целостности кода:</label>
        </textBox>
      </presentation>
    </presentationTable>
  </resources>
</policyDefinitionResources>
