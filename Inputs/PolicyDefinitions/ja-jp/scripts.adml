<?xml version="1.0" encoding="utf-8"?>
<!--  (c) 2006 Microsoft Corporation  -->
<policyDefinitionResources xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" revision="1.0" schemaVersion="1.0" xmlns="http://schemas.microsoft.com/GroupPolicy/2006/07/PolicyDefinitions">
  <displayName>表示名をここに入力する</displayName>
  <description>説明をここに入力する</description>
  <resources>
    <stringTable>
      <string id="MaxGPOScriptWaitPolicy">グループ ポリシー スクリプトの最大待機時間を指定する</string>
      <string id="MaxGPOScriptWaitPolicy_Help">このポリシー設定は、グループ ポリシーによって適用されるスクリプトの実行をシステムが待機する時間を決定します。

この設定によって、グループ ポリシーで適用されるすべてのログオン、ログオフ、起動およびシャットダウンのスクリプトが実行を終了するまでの合計時間が制限されます。指定時間が経過してもスクリプトが終了しない場合は、システムによってスクリプト処理が中止され、エラー イベントに記録されます。

この設定を有効にした場合、[時間 (秒):] ボックスに、一連のスクリプトの実行が終了するまでの待機時間の上限を 1 から 32,000 までの数字で入力できます。時間の長短にかかわらず、スクリプトが終了するまでシステムが待つように指定するには、「0」を入力してください。

このスクリプトが完了するまで他のシステムによるタスクを実行できない場合には、この間隔は特に重要となります。既定では、各起動スクリプトは、次のスクリプトが起動される前に完了する必要があります。また、[ログオン スクリプトを同期的に実行する] 設定を使って、ログオン スクリプトが完了するのを待ってからデスクトップを読み込むようにシステムを設定することができます。

間隔を長く設定しすぎると、システムに遅れが生じ、他のユーザーに迷惑がかかることがあります。しかし、間隔を短く設定しすぎると、必要なタスクが実行されずシステムが不完全な状態になる可能性があります。

この設定を無効にした場合、または構成しなかった場合、一連のスクリプトの実行時間の上限は 600 秒 (10 分) までです。これは既定値です。</string>
      <string id="Run_Legacy_Logon_Script_Hidden">実行中のレガシ ログオン スクリプトを表示しない</string>
      <string id="Run_Legacy_Logon_Script_Hidden_Explain">このポリシー設定は、Windows NT 4.0 およびそれ以前のバージョン用に作成されたログオン スクリプトの命令を非表示にします。

ログオン スクリプトは、ユーザーがログオンするときに実行される命令のバッチ ファイルです。既定では、Windows 2000 でログオン スクリプトが実行されると、コマンド ウィンドウに Windows 2000 のログオン スクリプトは表示されませんが、Windows NT 4.0 およびそれ以前のバージョンのログオン スクリプトの命令は表示されます。

この設定を有効にした場合、Windows 2000 には Windows NT 4.0 およびそれ以前のバージョンのログオン スクリプトは表示されません。

このポリシー設定を無効にした場合、または構成しなかった場合、Windows 2000 では Windows NT 4.0 およびそれ以前のバージョンのログイン スクリプトが表示されます。

[実行中のログオン スクリプトを表示する] 設定も参照してください。</string>

      <string id="Run_Logoff_Script_Visible">実行中のログオフ スクリプトの命令を表示する</string>
      <string id="Run_Logoff_Script_Visible_Explain">このポリシー設定は、実行中のログオフ スクリプトの命令を表示します。

ログオフ スクリプトは、ユーザーがログオフするときに実行される命令のバッチ ファイルです。既定では、ログオフ スクリプトの命令は表示されません。

このポリシー設定を有効にした場合、ログオフ スクリプトの実行時にそれぞれの命令が表示されます。命令はコマンド ウィンドウに表示されます。これは、詳しい知識のあるユーザー向けのポリシー設定です。

このポリシー設定を無効にした場合、または構成しなかった場合、命令は表示されません。</string>
      <string id="Run_Logon_Script_Sync">ログオン スクリプトを同期的に実行する</string>
      <string id="Run_Logon_Script_Sync_Help">このポリシー設定では、ログオン スクリプトの実行完了を待ってからエクスプローラー インターフェイス プログラム (デスクトップを表示するプログラム) を起動するようにします。

このポリシー設定を有効にした場合、ログオン スクリプトの実行が完了するまでエクスプローラーは起動されません。このポリシー設定を使うと、ユーザーが作業を始める前にログオン スクリプトの処理が完了するようにできますが、デスクトップの表示が遅くなります。

このポリシー設定を無効にした場合、または構成しなかった場合、ログオン スクリプトとエクスプローラーの同期はとられず、同時に実行することができます。

このポリシー設定は [コンピューターの構成] および [ユーザーの構成] フォルダーにあります。[コンピューターの構成] で指定されたポリシー設定は、[ユーザーの構成] で指定されたポリシー設定よりも優先されます。</string>
      <string id="Run_Logon_Script_Visible">実行中のログオン スクリプトの命令を表示する</string>
      <string id="Run_Logon_Script_Visible_Explain">このポリシー設定は、実行中のログオン スクリプトの命令を表示します。

ログオン スクリプトは、ユーザーがログオンするときに実行される命令のバッチ ファイルです。既定では、ログオン スクリプトの命令は表示されません。

このポリシー設定を有効にした場合、ログオン スクリプトの実行時にそれぞれの命令が表示されます。命令はコマンド ウィンドウに表示されます。これは、詳しい知識のあるユーザー向けのポリシー設定です。

このポリシー設定を無効にした場合、または構成しなかった場合、命令は表示されません。</string>

      <string id="Run_Computer_PS_Scripts_First">コンピューターのスタートアップ、シャットダウン時に Windows PowerShell スクリプトを最初に実行する</string>
      <string id="Run_Computer_PS_Scripts_First_Explain">このポリシー設定は、コンピューターのスタートアップおよびシャットダウン時に Windows PowerShell 以外のスクリプトよりも前に Windows PowerShell スクリプトを実行するかどうかを決定します。既定では、Windows PowerShell スクリプトは Windows PowerShell 以外のスクリプトの後に実行されます。
 
このポリシー設定を有効にした場合は、適用可能な各グループ ポリシー オブジェクト (GPO) 内で、コンピューターのスタートアップおよびシャットダウン時に Windows PowerShell 以外のスクリプトの前に Windows PowerShell スクリプトが実行されます。

例として、次のシナリオを取り上げます。

3 つの GPO (GPO A、GPO B、および GPO C) があります。このポリシー設定は GPO A で有効になっています。

GPO B と GPO C には、次のコンピューター スタートアップ スクリプトが含まれています。

GPO B: B.cmd、B.ps1
GPO C: C.cmd、C.ps1

また、DesktopIT および DesktopSales という名前の 2 台のコンピューターが存在します。
DesktopIT では、GPO A、B、および C が適用されています。したがって、DesktopIT では、GOP B と C のスクリプトは次の順序で実行されます。

GPO B 内: B.ps1、B.cmd
GPO C 内: C.ps1、C.cmd
 
DesktopSales の場合、GPO B と C が適用されていますが、GPO A は適用されていません。したがって、DesktopSales では、GPO B と C のスクリプトは次の順序で実行されます。

GPO B 内: B.cmd、B.ps1
GPO C 内: C.cmd、C.ps1

注: このポリシー設定では、適用可能なすべての GOP 内でコンピューターのスタートアップおよびシャットダウン スクリプトが実行される順序が決定されます。特定の GPO 内の特定のスクリプト タイプに対してこのポリシー設定を上書きするには、GPO の次のポリシー設定を構成します。
 
コンピューターの構成\ポリシー\Windows 設定\スクリプト (スタートアップ/シャットダウン)\スタートアップ
コンピューターの構成\ポリシー\Windows 設定\スクリプト (スタートアップ/シャットダウン)\シャットダウン

</string>
      <string id="Run_User_PS_Scripts_First">ユーザーのログオン、ログオフ時に Windows PowerShell スクリプトを最初に実行する</string>
      <string id="Run_User_PS_Scripts_First_Explain">このポリシー設定は、ユーザーのログオンおよびログオフ時に Windows PowerShell 以外のスクリプトよりも前に Windows PowerShell スクリプトを実行するかどうかを決定します。既定では、Windows PowerShell スクリプトは Windows PowerShell 以外のスクリプトの後に実行されます。
 
このポリシー設定を有効にした場合は、適用可能な各グループ ポリシー オブジェクト (GPO) 内で、ユーザーのログオンおよびログオフ時に PowerShell 以外のスクリプトの前に PowerShell スクリプトが実行されます。

例として、次のシナリオを取り上げます。

3 つの GPO (GPO A、GPO B、および GPO C) があります。このポリシー設定は GPO A で有効になっています。

GPO B と GPO C には、次のユーザーのログオン スクリプトが含まれています。

GPO B: B.cmd、B.ps1
GPO C: C.cmd、C.ps1

また、早川里美さんと金起成さんという名前の 2 人のユーザーが存在します。
早川さんには、GPO A、B、および C が適用されています。したがって、早川さんの場合、GOP B と C のスクリプトは次の順序で実行されます。

GPO B 内: B.ps1、B.cmd
GPO C 内: C.ps1、C.cmd
 
金さんには、GPO B と C が適用されていますが、GPO A は適用されていません。したがって、金さんの場合、GPO B と C のスクリプトは次の順序で実行されます。

GPO B 内: B.cmd、B.ps1
GPO C 内: C.cmd、C.ps1

注: このポリシー設定では、適用可能なすべての GOP 内でユーザーのログオンとログオフ スクリプトが実行される順序が決定されます。特定の GPO 内の特定のスクリプト タイプに対してこのポリシー設定を上書きするには、GPO の次のポリシー設定を構成します。
 
ユーザーの構成\ポリシー\Windows 設定\スクリプト (ログオン/ログオフ)\ログオン
ユーザーの構成\ポリシー\Windows 設定\スクリプト (ログオン/ログオフ)\ログオフ

このポリシー設定は、[コンピューターの構成] フォルダーと [ユーザーの構成] フォルダーに表示されます。[コンピューターの構成] で指定されたポリシー設定は、[ユーザーの構成] で指定された設定よりも優先されます。

</string>
      <string id="Run_Shutdown_Script_Visible">実行中のシャットダウン スクリプトの命令を表示する</string>
      <string id="Run_Shutdown_Script_Visible_Explain">このポリシー設定は、実行中のシャットダウン スクリプトの命令を表示します。

シャットダウン スクリプトは、ユーザーがシステムを再起動するとき、またはシャットダウンするときに実行される命令のバッチ ファイルです。既定では、シャットダウン スクリプトの命令は表示されません。

このポリシー設定を有効にした場合、シャットダウン スクリプトの実行時にそれぞれの命令が表示されます。命令はコマンド ウィンドウに表示されます。

このポリシー設定を無効にした場合、または構成しなかった場合、命令は表示されません。</string>
      <string id="Run_Startup_Script_Sync">スタートアップ スクリプトを非同期に実行する</string>
      <string id="Run_Startup_Script_Sync_Help">このポリシー設定を使用すると、複数のスタートアップ スクリプトが同時に実行されます。

スタートアップ スクリプトは、ユーザーがログオンする前に実行されるバッチ ファイルです。既定では、実行中のスタートアップ スクリプトが完了するまで次のスタートアップ スクリプトは実行されません。

このポリシー設定を有効にした場合、スタートアップ スクリプトの実行は調整されません。この結果、複数のスタートアップ スクリプトが同時に実行されることがあります。

このポリシー設定を無効にした場合、または構成しなかった場合、前のスクリプトが完了するまで次のスタートアップは実行されません。

注: Windows Vista オペレーティング システム以降では、[実行中のスタートアップ スクリプトを表示する] ポリシー設定が有効か無効かに関係なく、非同期に実行するように構成されているスクリプトはスタートアップで表示されません。</string>
      <string id="Run_Startup_Script_Visible">実行中のスタートアップ スクリプトの命令を表示する</string>
      <string id="Run_Startup_Script_Visible_Explain">このポリシー設定は、実行中のスタートアップ スクリプトの命令を表示します。

スタートアップ スクリプトは、ユーザーがログオンする前に実行される命令のバッチ ファイルです。既定では、スタートアップ スクリプトの命令は表示されません。

このポリシー設定を有効にした場合、スタートアップ スクリプトの実行時にそれぞれの命令が表示されます。命令はコマンド ウィンドウに表示されます。これは、詳しい知識のあるユーザー向けのポリシー設定です。

このポリシー設定を無効にした場合、または構成しなかった場合、命令は表示されません。

注: Windows Vista オペレーティング システム以降では、このポリシー設定が有効か無効かに関係なく、非同期に実行するように構成されているスクリプトはスタートアップで表示されません。</string>
      <string id="Allow_Logon_Script_NetbiosDisabled">NetBIOS または WINS が無効の場合にログオン スクリプトを許可する</string>
      <string id="Allow_Logon_Script_NetbiosDisabled_Explain">このポリシー設定を使用すると、フォレストを越えたログオンと DNS サフィックスへのログオンが構成されておらず、NetBIOS または WINS が無効の場合、ユーザーはログオン スクリプトを実行することができるようになります。このポリシー設定は、コンピューターに対話的にログオンするすべてのユーザーに影響します。

このポリシー設定を有効にすると、NetBIOS または WINS が無効の場合、フォレストを越えたログオン中にユーザー ログオン スクリプトが実行されます。この際、DNS サフィックスは構成されません。

このポリシー設定を無効にした場合、または構成しなかった場合、NetBIOS または WINS が無効になっていて DNS サフィックスが構成されていなければ、ユーザー アカウントのフォレストを越えた対話的なログオン スクリプトは実行できません。</string>
      <string id="Scripts">スクリプト</string>
    </stringTable>
    <presentationTable>
      <presentation id="MaxGPOScriptWaitPolicy">
        <decimalTextBox refId="MaxGPOScriptWait" defaultValue="600">時間 (秒):</decimalTextBox>
        <text>範囲は 0 から 32000 まで、待ち時間を無制限にするには 0 を使用してください。</text>
      </presentation>
    </presentationTable>
  </resources>
</policyDefinitionResources>
